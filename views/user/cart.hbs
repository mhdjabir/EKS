<section>
    <div class="container">
        {{#if products.length}}
        <h2 class="text-center mt-5">Cart</h2>
        <div class="table-responsive">
            <table class="table table-hover">
                <thead class="thead-dark">
                    <tr>
                        <th scope="col"></th>
                        <th scope="col">Item</th>
                        <th scope="col">Weight</th>
                        <th scope="col">Price</th>
                        <th scope="col">Quantity</th>
                        <th scope="col"></th>
                    </tr>
                </thead>
                <tbody>
                    {{#each products}}
                    <tr id="product-row-{{this.item}}">
                        <td>
                            <img style="width: 70px; height: 70px; object-fit: cover; border-radius: 5px;"
                                src="/product-images/{{this.productDetails._id}}.jpg">
                        </td>
                        <td class="align-middle">{{this.productDetails.name}}</td>
                        <td class="align-middle">{{this.productDetails.weight}}</td>
                        <td class="align-middle">₹{{this.productDetails.price}}</td>
                        <td class="align-middle">
                            <div class="d-flex align-items-center justify-content-center">
                                <button class="cart-item-count btn mr-2"
                                    onclick="changeQuantity('{{this.item}}', '{{../user._id}}', -1)">-</button>
                                <span id="quantity-{{this.item}}" class="quantity-display mx-2">{{this.quantity}}</span>
                                <button class="cart-item-count btn ml-2"
                                    onclick="changeQuantity('{{this.item}}', '{{../user._id}}', 1)">+</button>
                            </div>
                        </td>
                        <td class="align-middle">
                            <a href="#" class="btn btn-danger fa fa-trash btn-sm"
                                onclick="removeProduct('{{this.item}}', '{{../user._id}}')"></a>
                        </td>
                    </tr>
                    {{/each}}
                </tbody>
            </table>
        </div>

        <div class="text-right mt-3">
            {{#if (gt total 1000)}}
            <p class="text-success font-weight-bold">You got ₹99 discount! You ordered more than ₹1000.</p>
            {{/if}}
            <h4 class="font-weight-bold">Total: ₹<span id="total-price">{{total}}</span></h4>
        </div>

        <div class="text-right mt-3">
            <a href="/place-order" class="btn btn-custom mr-2">Place order</a>
        </div>
        {{else}}
        <div class="text-center mt-5">
            <h4>Your cart is empty!</h4>
            <a href="/" class="btn btn-primary mt-3">Shop Now</a>
        </div>
        {{/if}}
    </div>
</section>
